<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="generator" content="MarkBind 5.5.3">
    <meta name="viewport" content="width=device-width, initial-scale=1"><title>Architecture and Packages</title> <link rel="stylesheet" href="/mb-architecture/markbind/css/bootstrap.min.css"> <link rel="stylesheet" href="/mb-architecture/markbind/fontawesome/css/all.min.css"> <link rel="stylesheet" href="/mb-architecture/markbind/glyphicons/css/bootstrap-glyphicons.min.css"><link rel="stylesheet" href="/mb-architecture/markbind/css/codeblock-dark.min.css"><link rel="stylesheet" href="/mb-architecture/markbind/css/markbind.min.css"><link rel="stylesheet" href="/mb-architecture/plugins/markbind-plugin-anchors/markbind-plugin-anchors.css"><link rel="stylesheet" href="/mb-architecture/plugins/markbind-plugin-tree/markbind-plugin-tree.css">
    
  <link rel="stylesheet" href="/mb-architecture/stylesheets/main.css">
</head>
<script>
  const baseUrl = '/mb-architecture'
</script>
<body  data-bs-spy="scroll" data-bs-target="#mb-page-nav" data-bs-offset="100" >
<div id="app" data-server-rendered="true"><header sticky=""><div data-v-7c0fd418><nav class="navbar navbar-expand-md d-print-none navbar-dark bg-dark" data-v-7c0fd418><div class="container-fluid" data-v-7c0fd418><div class="navbar-left" data-v-7c0fd418><a href="/mb-architecture/index.html" title="Home" class="navbar-brand" data-v-7c0fd418><img src="/mb-architecture/assets/logo.png" height="70" data-v-7c0fd418></a></div> <div class="navbar-default" data-v-7c0fd418><ul class="navbar-nav me-auto mt-2 mt-lg-0" data-v-7c0fd418> <li data-v-7c0fd418><a href="/mb-architecture/contents/architecture.html" class="nav-link" data-v-7c0fd418>Architecture</a></li> <li class="nav-link dropdown" data-v-99624572><a role="button" data-bs-toggle="dropdown" class="dropdown-toggle nav-link" data-v-99624572>Command Line (CLI Library) <span data-v-99624572></span></a> <ul class="dropdown-menu" data-v-99624572> <li data-v-99624572><a href="/mb-architecture/contents/cli.html" class="dropdown-item" data-v-99624572>CLI</a></li></ul></li> <li class="nav-link dropdown" data-v-99624572><a role="button" data-bs-toggle="dropdown" class="dropdown-toggle nav-link" data-v-99624572>Core Library <span data-v-99624572></span></a> <ul class="dropdown-menu" data-v-99624572> <li data-v-99624572><a href="/mb-architecture/contents/core/site_class.html" class="dropdown-item" data-v-99624572>Site, SiteConfig</a></li> <li data-v-99624572><a href="/mb-architecture/contents/core/page_class.html" class="dropdown-item" data-v-99624572>Page, PageConfig</a></li> <li data-v-99624572><a href="/mb-architecture/contents/core/pageVueServerRenderer.html" class="dropdown-item" data-v-99624572>PageVueServerRenderer</a></li> <li data-v-99624572><a href="/mb-architecture/contents/core/layout.html" class="dropdown-item" data-v-99624572>Layout, LayoutManager</a></li> <li data-v-99624572><a href="/mb-architecture/contents/core/variableProcessorRenderer.html" class="dropdown-item" data-v-99624572>VariableProcessor/Renderer</a></li> <li data-v-99624572><a href="/mb-architecture/contents/core/external.html" class="dropdown-item" data-v-99624572>ExternalManager, External</a></li> <li data-v-99624572><a href="/mb-architecture/contents/core/template.html" class="dropdown-item" data-v-99624572>Project Templates</a></li> <li class="nav-link dropdown-submenu dropend" data-v-3c82541c data-v-99624572><a role="button" data-bs-toggle="dropdown" class="dropdown-item submenu-toggle" data-v-3c82541c>Process to html</a> <ul class="dropdown-menu" data-v-3c82541c> <li data-v-3c82541c><a href="/mb-architecture/contents/core/html/nodeProcessor.html" class="dropdown-item" data-v-3c82541c>NodeProcessor</a></li> <li data-v-3c82541c><a href="/mb-architecture/contents/core/html/otherProcessors.html" class="dropdown-item" data-v-3c82541c>otherProcessors</a></li> <li data-v-3c82541c><a href="/mb-architecture/contents/core/html/vueSlotSyntaxProcessor.html" class="dropdown-item" data-v-3c82541c>vueSlotSyntaxProcessor</a></li></ul></li></ul></li> <li class="nav-link dropdown" data-v-99624572><a role="button" data-bs-toggle="dropdown" class="dropdown-toggle nav-link" data-v-99624572>Core-Web Library <span data-v-99624572></span></a> <ul class="dropdown-menu" data-v-99624572> <li data-v-99624572><a href="/mb-architecture/contents/core-web/core-web.html" class="dropdown-item" data-v-99624572>core-web</a></li></ul></li> <li class="nav-link dropdown" data-v-99624572><a role="button" data-bs-toggle="dropdown" class="dropdown-toggle nav-link" data-v-99624572>Vue-Components Library <span data-v-99624572></span></a> <ul class="dropdown-menu" data-v-99624572> <li data-v-99624572><a href="/mb-architecture/contents/vue/vueComponents.html" class="dropdown-item" data-v-99624572>vue-components</a></li></ul></li></ul></div> <ul class="navbar-nav navbar-right" data-v-7c0fd418><li data-v-7c0fd418><form class="navbar-form" data-v-7c0fd418><div class="dropdown" style="position:relative;" data-v-4f6e9aec><input data-bs-toggle="dropdown" type="text" placeholder="Search" autocomplete="off" value="" class="form-control" data-v-4f6e9aec> <div class="form-control placeholder-div-hidden" data-v-4f6e9aec>
      Search
    </div> <ul class="dropdown-menu search-dropdown-menu dropdown-menu-hidden dropdown-menu-end" data-v-4f6e9aec></ul></div></form></li></ul></div></nav> <div class="lower-navbar-container" style="display:none;" data-v-7c0fd418><!----> <!----></div></div></header> <div id="flex-body"><nav id="site-nav" data-v-e6005420><div class="site-nav-top" data-v-e6005420><div class="fw-bold mb-2" style="font-size:1.25rem;" data-v-e6005420>Contents</div></div> <div class="nav-component slim-scroll" data-v-e6005420><div class="site-nav-root"><ul class="site-nav-list site-nav-list-root" data-v-e6005420><li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e6005420><a href="/mb-architecture/index.html" data-v-e6005420>How does MarkBind Work üè†</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e6005420><a href="/mb-architecture/contents/architecture.html" data-v-e6005420>Architecture</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e6005420>CLI Library 

<div class="site-nav-dropdown-btn-container" data-v-e6005420><i onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();" class="site-nav-dropdown-btn-icon site-nav-rotate-icon" data-v-e6005420><span aria-hidden="true" class="glyphicon glyphicon-menu-down" data-v-e6005420></span></i></div></div><ul class="site-nav-dropdown-container site-nav-dropdown-container-open site-nav-list" data-v-e6005420><li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/cli.html" data-v-e6005420>Command Line Interface</a></div></li></ul></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e6005420>Core Library 

<div class="site-nav-dropdown-btn-container" data-v-e6005420><i onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();" class="site-nav-dropdown-btn-icon site-nav-rotate-icon" data-v-e6005420><span aria-hidden="true" class="glyphicon glyphicon-menu-down" data-v-e6005420></span></i></div></div><ul class="site-nav-dropdown-container site-nav-dropdown-container-open site-nav-list" data-v-e6005420><li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/core/site_class.html" data-v-e6005420>Site, SiteConfig Class</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/core/page_class.html" data-v-e6005420>Page, PageConfig Class</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/core/pageVueServerRenderer.html" data-v-e6005420>PageVueServerRenderer</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/core/layout.html" data-v-e6005420>Layout, Layout Manager Classes</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/core/variableProcessorRenderer.html" data-v-e6005420>VariableProcessor/Renderer Classes</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420>html Library 

<div class="site-nav-dropdown-btn-container" data-v-e6005420><i onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();" class="site-nav-dropdown-btn-icon site-nav-rotate-icon" data-v-e6005420><span aria-hidden="true" class="glyphicon glyphicon-menu-down" data-v-e6005420></span></i></div></div><ul class="site-nav-dropdown-container site-nav-dropdown-container-open site-nav-list" data-v-e6005420><li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-2" data-v-e6005420><a href="/mb-architecture/contents/core/html/nodeProcessor.html" data-v-e6005420>NodeProcessor</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-2" data-v-e6005420><a href="/mb-architecture/contents/core/html/otherProcessors.html" data-v-e6005420>Other Processors</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-2" data-v-e6005420><a href="/mb-architecture/contents/core/html/vueSlotSyntaxProcessor.html" data-v-e6005420>VueSlotSyntaxProcessor</a></div></li></ul></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/core/external.html" data-v-e6005420>ExternalManager, External Classes</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/core/template.html" data-v-e6005420>Project Templates</a></div></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/core/lib.html" data-v-e6005420>Lib</a></div></li></ul></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e6005420>Core Web Library 

<div class="site-nav-dropdown-btn-container" data-v-e6005420><i onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();" class="site-nav-dropdown-btn-icon site-nav-rotate-icon" data-v-e6005420><span aria-hidden="true" class="glyphicon glyphicon-menu-down" data-v-e6005420></span></i></div></div><ul class="site-nav-dropdown-container site-nav-dropdown-container-open site-nav-list" data-v-e6005420><li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/core-web/core-web.html" data-v-e6005420>core-web</a></div></li></ul></li> <li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e6005420>Vue Components 

<div class="site-nav-dropdown-btn-container" data-v-e6005420><i onclick="handleSiteNavClick(this.parentNode.parentNode, false); event.stopPropagation();" class="site-nav-dropdown-btn-icon site-nav-rotate-icon" data-v-e6005420><span aria-hidden="true" class="glyphicon glyphicon-menu-down" data-v-e6005420></span></i></div></div><ul class="site-nav-dropdown-container site-nav-dropdown-container-open site-nav-list" data-v-e6005420><li data-v-e6005420><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e6005420><a href="/mb-architecture/contents/vue/vueComponents.html" data-v-e6005420>Vue-components</a></div></li></ul></li> <!----></ul></div></div> <!----></nav> <div id="content-wrapper"><div data-v-ef898034><nav aria-label="breadcrumb" class="breadcrumb-divider" data-v-ef898034><ol class="breadcrumb" data-v-ef898034><li class="notlink breadcrumb-marker" data-v-ef898034>
        ‚Ä∫‚Ä∫¬†¬†
      </li> </ol></nav></div> <h1 id="packages">Packages<a href="#packages" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h1> <p>The MarkBind project is developed in a <span data-mb-component-type="tooltip" tabindex="0" class="trigger"><!----><!----></span> (<a href="https://github.com/MarkBind/markbind">MarkBind/markbind</a>) of 4 packages:</p> <ul><li><p>The core library, which parses and processes MarkBind's various syntaxes, resides in the <code class="hljs inline no-lang">packages/core/</code> directory.</p></li> <li><p>The command-line interface (CLI) application, which accepts commands from users and then uses the core library to parse and generate web pages, resides in the <code class="hljs inline no-lang">packages/cli/</code> directory.</p></li> <li><p>The core web library, which contains a generated web bundle from various setup scripts and the UI components library, resides in <code class="hljs inline no-lang">packages/core-web/</code>.</p></li> <li><p>The UI components library, which MarkBind authors can use to create content with complex and interactive structure, resides in the <code class="hljs inline no-lang">packages/vue-components/</code> directory.</p> <p>Stack used: <em>Node.js</em>, <em>Vue.js</em></p></li></ul> <h3 id="markbind-core-library">MarkBind core library<a href="#markbind-core-library" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p><strong>The core library mainly houses:</strong></p> <ul><li><p>Functions and libraries used to parse and process MarkBind into usable output are stored in <code class="hljs inline no-lang">src</code>. The architecture described in <a href="/mb-architecture/contents/architecture.html">Architecture</a> is contained here. A brief rundown of what it includes:</p> <ul><li><p>Various key functionalities in processing MarkBind syntax into valid HTML output, stored in <code class="hljs inline no-lang">html</code>. The other part of the content processing flow is found in <code class="hljs inline no-lang">variables</code>, which manages site variables and facilitates the Nunjucks calls.</p></li> <li><p><code class="hljs inline no-lang">Page</code> files generate a single page of the site, and are managed by the <code class="hljs inline no-lang">Site</code> instance. <code class="hljs inline no-lang">Site</code> uses the Page model's interface to generate pages, and performs various other utility-like functions related to site generation such as copying of external assets into the output folder.</p></li> <li><p><code class="hljs inline no-lang">Layout</code> holds the files relating to the layout of the site and are managed by <code class="hljs inline no-lang">LayoutManager</code>. Similarly, <code class="hljs inline no-lang">External</code> files, which are separate output files to be loaded dynamically and on-demand, are managed by a <code class="hljs inline no-lang">ExternalManager</code> instance.</p></li> <li><p>Various libraries (contained in <code class="hljs inline no-lang">lib</code>) and plugins (in <code class="hljs inline no-lang">plugins</code>) are also stored here. Some external libraries have also been amended to suit MarkBind's purpose ‚Äì see <code class="hljs inline no-lang">patches</code>.</p></li></ul></li> <li><p>MarkBind's templates <a tags="environment--dg" href="https://markbind.org/userGuide/templates.html">templates</a>, used in the <code class="hljs inline no-lang">markbind init</code> command.</p></li> <li><p>Unit Tests (though there are more unit tests and functional tests in the cli library)</p></li></ul> <p><strong>The key external libraries used are:</strong></p> <ul><li><p><a href="https://github.com/markdown-it/markdown-it">markdown-it</a>, which does the Markdown parsing and rendering. There are also several customized markdown-it plugins used in MarkBind, which are located inside the <code class="hljs inline no-lang">src/lib/markdown-it/</code> directory.</p> <ul><li><p>Several markdown-it plugins are installed to enhance the existing Markdown syntax. They can be found in <code class="hljs inline no-lang">src/package.json</code>. Some of them are patched in the <code class="hljs inline no-lang">src/lib/markdown-it/patches/</code> directory to fit MarkBind's needs.</p></li> <li><p>Additionally, there are some markdown-it plugins in the <code class="hljs inline no-lang">src/lib/markdown-it/plugins/</code> directory (either forked, modified or written to enhance existing functionalities).</p></li></ul></li> <li><p><a href="https://github.com/fb55/htmlparser2">htmlparser2</a>, a speedy and forgiving HTML parser which exposes a DOM-like object structure to work on. To comply with the markdown spec, and our custom requirements, <code class="hljs inline no-lang">src/patches/htmlparser2.js</code> patches various behaviours of this library.</p></li> <li><p><a href="https://cheerio.js.org/">cheerio</a>, which is a node.js equivalent of <a href="https://jquery.com/">jQuery</a>. Cheerio uses <a href="https://github.com/fb55/htmlparser2">htmlparser2</a> to parse the HTML as well, hence our patches propagate here.</p></li> <li><p><a href="https://mozilla.github.io/nunjucks/">Nunjucks</a>, which is a JavaScript templating engine. Nunjucks is used to support our variable system to help with reusing small bits of code in multiple places. The package is patched and stored in <code class="hljs inline no-lang">src/patches/nunjucks</code> to make it compatible with other MarkBind syntax processing steps.</p></li></ul> <h3 id="markbind-cli">MarkBind CLI<a href="#markbind-cli" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>The CLI application uses and further builds on the interface exposed by the core library's <code class="hljs inline no-lang">Site</code> model to provide functionalities for the author, such as <code class="hljs inline no-lang">markbind serve</code> which initiates a live reload workflow.</p> <p><strong>The key external libraries used are:</strong></p> <ul><li><p><a href="https://github.com/tj/commander.js/">commander.js</a>, which is a node.js CLI framework.</p></li> <li><p><a href="https://github.com/tapio/live-server">live-server</a>, which is a simple web server for local development and preview of a MarkBind site. The package is patched and stored in <code class="hljs inline no-lang">src/lib/live-server</code> with our custom fine tuning.</p></li></ul> <h3 id="markbind-core-web-library">MarkBind core-web library<a href="#markbind-core-web-library" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>This package houses the various frontend assets used in the core package.</p> <p>Some external assets included are Vue.js, Bootstrap bundles, and FontAwesome bundles.</p> <p>Internal bundles are also present, generated from setup scripts, custom stylesheets and the UI components library.</p> <h3 id="ui-components-library">UI components library<a href="#ui-components-library" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>This package consists of a mix of <a href="https://getbootstrap.com/components/">Bootstrap</a> and proprietary components rewritten in <a href="https://vuejs.org">Vue.js</a> based on our needs for educational websites.</p> <p>We forked it from the original <a href="https://github.com/yuche/vue-strap">yuche/vue-strap</a> repo into the <a href="https://github.com/MarkBind/vue-strap">MarkBind/vue-strap</a> repo, and then later merged it into the main <a href="https://github.com/MarkBind/markbind">MarkBind/markbind</a> repo.</p> <h1 id="architecture">Architecture<a href="#architecture" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h1> <div class="lead mb-5"><p>This page provides an overview of the MarkBind's architecture.</p></div> <p><a href="/mb-architecture/diagrams/architecture.png" target="_self"><img src="/mb-architecture/diagrams/architecture.png" alt="MarkBind Architecture Diagram" class="img-fluid"></a></p> <p>The above diagram shows the key classes and <span data-mb-component-type="popover" tabindex="0" class="trigger"><!----><!----></span> in MarkBind. You may note the following from these:</p> <h3 id="key-classes">Key classes<a href="#key-classes" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>The 3 key classes representing different types of content are as follows:</p> <ol><li><code class="hljs inline no-lang">Page</code> ‚Äî a page, as specified by the user in their various site configuration <code class="hljs inline no-lang">glob</code> or <code class="hljs inline no-lang">src</code> properties. These are directly managed by the <code class="hljs inline no-lang">Site</code> instance.</li> <li><code class="hljs inline no-lang">Layout</code> ‚Äî a single layout file, as contained in the <code class="hljs inline no-lang">_markbind/layouts</code> folder, collectively managed by <code class="hljs inline no-lang">LayoutManager</code>.</li></ol> <div class="alert box-container seamless" data-v-474166ec><!----> <div class="header-and-body" data-v-474166ec><!----> <div class="box-body-wrapper" data-v-474166ec><div class="icon-wrapper  text-success" data-v-474166ec><i class="fas fa-lightbulb" data-v-474166ec></i></div> <div aria-hidden="true" class="vertical-divider alert-success" data-v-474166ec></div> <div class="contents" data-v-474166ec><p data-v-474166ec>Note that <code class="hljs inline no-lang" data-v-474166ec>Layout</code> instances do not generate any output files directly, but rather, they store intermediate processing results to be used in a <code class="hljs inline no-lang" data-v-474166ec>Page</code>.</p></div> <!----></div></div></div> <ol><li><code class="hljs inline no-lang">External</code> ‚Äî source files referenced in a <code class="hljs inline no-lang">Page</code>, <code class="hljs inline no-lang">Layout</code> or even another <code class="hljs inline no-lang">External</code> that result in a <span data-mb-component-type="tooltip" tabindex="0" class="trigger"><!----><!----></span> output file. These output files are loaded dynamically and on-demand in the browser. These instances are managed by a single <code class="hljs inline no-lang">ExternalManager</code> instance.</li></ol> <div class="alert box-container seamless" data-v-474166ec><!----> <div class="header-and-body" data-v-474166ec><!----> <div class="box-body-wrapper" data-v-474166ec><div class="icon-wrapper  text-info" data-v-474166ec><i class="fas fa-info" data-v-474166ec></i></div> <div aria-hidden="true" class="vertical-divider alert-info" data-v-474166ec></div> <div class="contents" data-v-474166ec><p data-v-474166ec>For example, the file referenced by a <code class="hljs inline no-lang" data-v-474166ec>&lt;panel src=&quot;xx.md&quot;&gt;</code> generates a separate <code class="hljs inline no-lang" data-v-474166ec>xx._include_.html</code>, which is requested and loaded only when the panel is expanded.</p></div> <!----></div></div></div> <h3 id="content-processing-flow">Content processing flow<a href="#content-processing-flow" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>Every <code class="hljs inline no-lang">Page</code>, <code class="hljs inline no-lang">Layout</code> and <code class="hljs inline no-lang">External</code> follows the same overall content processing flow, that is:</p> <p><em>Nunjucks <span aria-hidden="true" class="fas fa-arrow-right"></span> Markdown <span aria-hidden="true" class="fas fa-arrow-right"></span> Html</em></p> <div class="alert box-container seamless" data-v-474166ec><!----> <div class="header-and-body" data-v-474166ec><!----> <div class="box-body-wrapper" data-v-474166ec><div class="icon-wrapper  text-info" data-v-474166ec><i class="fas fa-info" data-v-474166ec></i></div> <div aria-hidden="true" class="vertical-divider alert-info" data-v-474166ec></div> <div class="contents" data-v-474166ec><p data-v-474166ec>Note that generation of <code class="hljs inline no-lang" data-v-474166ec>External</code>s (e.g. <code class="hljs inline no-lang" data-v-474166ec>&lt;panel src=&quot;...&quot;&gt;</code>) <strong data-v-474166ec>do not fall within</strong> the content processing flow <span class="underline" data-v-474166ec>where they are <strong data-v-474166ec>referenced</strong></span>.
These are only flagged for generation, and then processed by <code class="hljs inline no-lang" data-v-474166ec>ExternalManager</code> <strong data-v-474166ec>after</strong>, in <strong data-v-474166ec>another</strong> similar content processing flow within an <code class="hljs inline no-lang" data-v-474166ec>External</code> instance.</p></div> <!----></div></div></div> <p><strong><strong>Rationale</strong></strong></p> <p>This simple three stage flow provides a simple, predictable content processing flow for the user, and removes several other development concerns:</p> <ol><li><p>As the templating language of choice, Nunjucks is always processed first, allowing its templating capabilities to be used to the full extent.
Its syntax is also the most compatible and independent of the other stages.</p></li> <li><p>Secondly, Markdown is <strong>rendered before HTML</strong>, which produces more HTML. This also allows core Markdown features (e.g. code blocks) and Markdown plugins with eccentric syntaxes to be used without having to patch the HTML parser.</p></li> <li><p>Having processed possibly conflicting Nunjucks and Markdown syntax, HTML is then processed last.</p></li></ol> <div class="clearfix"><span class="float-start"><a href="/mb-architecture/index.html" class="btn btn-light"><span><span aria-hidden="true" class="far fa-arrow-alt-circle-left"></span> Home</span></a></span> <span class="float-end"><a href="/mb-architecture/contents/cli.html" class="btn btn-light"><span> Command Line Interface <span aria-hidden="true" class="far fa-arrow-alt-circle-right"></span></span></a></span></div> <br> <h1 id="how-markbind-works">How MarkBind Works<a href="#how-markbind-works" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h1> <p>A summary from senior <a href="https://nus-cs3281.github.io/2024/#xu-shuyao">CS3281-2024</a></p> <h2 id="markbind-rendering-flow">MarkBind Rendering Flow<a href="#markbind-rendering-flow" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h2> <p>The rendering flow for creating a complete website from Markdown using MarkBind involves several key components and processes:</p> <h3 id="1-site-initialization"><strong>1. Site Initialization</strong><a href="#1-site-initialization" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>The rendering process starts with the initialization of a <code class="hljs inline no-lang">Site</code> instance in <code class="hljs inline no-lang">Site/index.ts</code>.</li> <li>The <code class="hljs inline no-lang">Site</code> constructor sets up the necessary paths, templates, and initializes various managers and processors.</li></ul> <h3 id="2-site-configuration"><strong>2. Site Configuration</strong><a href="#2-site-configuration" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>The <code class="hljs inline no-lang">readSiteConfig</code> method in <code class="hljs inline no-lang">Site/index.ts</code> reads the site configuration file (<code class="hljs inline no-lang">site.json</code>) using the <code class="hljs inline no-lang">SiteConfig</code> class.</li> <li>The site configuration includes settings such as base URL, page configuration, asset paths, and more.</li></ul> <h3 id="3-page-collection"><strong>3. Page Collection</strong><a href="#3-page-collection" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>The <code class="hljs inline no-lang">collectAddressablePages</code> method in <code class="hljs inline no-lang">Site/index.ts</code> collects the addressable pages based on the site configuration.</li> <li>It processes the <code class="hljs inline no-lang">pages</code> and <code class="hljs inline no-lang">pagesExclude</code> options to determine the valid pages.</li></ul> <h3 id="4-plugin-setup"><strong>4. Plugin Setup</strong><a href="#4-plugin-setup" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>The <code class="hljs inline no-lang">PluginManager</code> class in <code class="hljs inline no-lang">plugins/PluginManager.ts</code> handles the initialization and management of plugins.</li> <li>It collects the specified plugins from the site configuration and loads them using the <code class="hljs inline no-lang">Plugin</code> class.</li></ul> <h3 id="5-asset-building"><strong>5. Asset Building</strong><a href="#5-asset-building" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>The <code class="hljs inline no-lang">buildAssets</code> method in <code class="hljs inline no-lang">Site/index.ts</code> builds the necessary assets for the site.</li> <li>It copies the specified assets from the site's root path to the output path.</li></ul> <h3 id="6-markdown-processing"><strong>6. Markdown Processing</strong><a href="#6-markdown-processing" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>The <code class="hljs inline no-lang">generatePages</code> method in <code class="hljs inline no-lang">Site/index.ts</code> initiates the rendering process for each page.</li> <li>It creates a <code class="hljs inline no-lang">Page</code> instance for each page using the <code class="hljs inline no-lang">createPage</code> method.</li> <li>The <code class="hljs inline no-lang">Page</code> class in <code class="hljs inline no-lang">Page/index.ts</code> handles the rendering of individual pages.</li> <li>It uses the <code class="hljs inline no-lang">process</code> method of the <code class="hljs inline no-lang">NodeProcessor</code> class to process the Markdown content.</li></ul> <h3 id="7-plugin-execution"><strong>7. Plugin Execution</strong><a href="#7-plugin-execution" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>During the page rendering process, the <code class="hljs inline no-lang">PluginManager</code> executes the relevant hooks for each plugin.</li> <li>Plugins can define hooks such as <code class="hljs inline no-lang">beforeSiteGenerate</code>, <code class="hljs inline no-lang">processNode</code>, <code class="hljs inline no-lang">postRender</code>, etc., to modify the page content or perform additional tasks.</li></ul> <h3 id="8-layout-and-template-rendering"><strong>8. Layout and Template Rendering</strong><a href="#8-layout-and-template-rendering" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>The <code class="hljs inline no-lang">LayoutManager</code> class in <code class="hljs inline no-lang">Layout/LayoutManager.ts</code> handles the generation and combination of layouts with pages.</li> <li>It uses the <code class="hljs inline no-lang">Layout</code> class to process and render the layout files.</li> <li>The rendered pages are then passed through the <code class="hljs inline no-lang">VariableProcessor</code> to replace variables with their corresponding values.</li></ul> <h3 id="9-post-rendering-tasks"><strong>9. Post-rendering Tasks</strong><a href="#9-post-rendering-tasks" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>After rendering, additional tasks such as writing site data and copying core web assets are performed.</li></ul> <h3 id="10-output-generation"><strong>10. Output Generation</strong><a href="#10-output-generation" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>Finally, the rendered pages and assets are written to the output directory specified during site initialization.</li></ul> <hr> <h2 id="vue-js-integration-in-markbind"><strong>Vue.js Integration in MarkBind</strong><a href="#vue-js-integration-in-markbind" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h2> <p>MarkBind integrates Vue.js for building user interfaces and enhancing the rendering process. Here's how Vue.js is used in MarkBind:</p> <h3 id="1-server-side-rendering-ssr"><strong>1. Server-Side Rendering (SSR)</strong><a href="#1-server-side-rendering-ssr" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>MarkBind utilizes Vue's <strong>server-side rendering</strong> capabilities to pre-render the pages on the server.</li> <li>The <code class="hljs inline no-lang">pageVueServerRenderer</code> module in <code class="hljs inline no-lang">Page/PageVueServerRenderer.ts</code> handles the compilation of Vue pages and the creation of render functions.</li></ul> <h3 id="2-client-side-hydration"><strong>2. Client-Side Hydration</strong><a href="#2-client-side-hydration" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>After the initial <strong>server-side rendering</strong>, the rendered HTML is sent to the client.</li> <li>On the <strong>client-side</strong>, Vue takes over and <strong>hydrates</strong> the pre-rendered HTML, making it interactive and reactive.</li></ul> <h3 id="3-vue-components"><strong>3. Vue Components</strong><a href="#3-vue-components" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>MarkBind defines various <strong>Vue components</strong> to encapsulate reusable UI elements and functionality.</li> <li>These components are used throughout the rendered pages to enhance the user experience.</li></ul> <h3 id="4-integration-with-markbind-plugins"><strong>4. Integration with MarkBind Plugins</strong><a href="#4-integration-with-markbind-plugins" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>MarkBind plugins can also utilize <strong>Vue.js</strong> to extend the functionality of the application.</li> <li>Plugins can define <strong>custom Vue components, directives, and hooks</strong> to interact with the rendering process.</li></ul> <hr> <h2 id="build-process-and-asset-management"><strong>Build Process and Asset Management</strong><a href="#build-process-and-asset-management" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h2> <p>MarkBind follows a build process to generate the final website and manage the necessary assets:</p> <h3 id="1-asset-building"><strong>1. Asset Building</strong><a href="#1-asset-building" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>The <code class="hljs inline no-lang">buildAssets</code> method in <code class="hljs inline no-lang">Site/index.ts</code> handles the <strong>building of assets</strong> for the site.</li> <li>It copies the specified assets from the site's root path to the output path.</li></ul> <h3 id="2-core-web-assets"><strong>2. Core Web Assets</strong><a href="#2-core-web-assets" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>MarkBind relies on <strong>core web assets</strong> such as CSS and JavaScript files.</li> <li>The <code class="hljs inline no-lang">copyCoreWebAsset</code> method in <code class="hljs inline no-lang">Site/index.ts</code> copies these assets from the <code class="hljs inline no-lang">@markbind/core-web</code> package to the output directory.</li></ul> <h3 id="3-plugin-assets"><strong>3. Plugin Assets</strong><a href="#3-plugin-assets" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>Plugins can also provide their own assets, such as <strong>CSS and JavaScript files</strong>.</li> <li>The <code class="hljs inline no-lang">PluginManager</code> handles the <strong>collection and copying</strong> of plugin assets to the output directory.</li></ul> <h3 id="4-icon-assets"><strong>4. Icon Assets</strong><a href="#4-icon-assets" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>MarkBind supports various <strong>icon libraries</strong>, including:
<ul><li>Font Awesome</li> <li>Glyphicons</li> <li>Octicons</li> <li>Material Icons</li></ul></li> <li>The following methods in <code class="hljs inline no-lang">Site/index.ts</code> handle the copying of these assets:
<ul><li><code class="hljs inline no-lang">copyFontAwesomeAsset</code></li> <li><code class="hljs inline no-lang">copyOcticonsAsset</code></li> <li><code class="hljs inline no-lang">copyMaterialIconsAsset</code></li></ul></li></ul> <h3 id="5-bootstrap-theme"><strong>5. Bootstrap Theme</strong><a href="#5-bootstrap-theme" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>MarkBind allows customization of the <strong>Bootstrap theme</strong> used in the site.</li> <li>The <code class="hljs inline no-lang">copyBootstrapTheme</code> method in <code class="hljs inline no-lang">Site/index.ts</code> handles the copying of the selected Bootstrap theme to the output directory.</li></ul></div> <nav id="page-nav" data-v-e6005420><div class="nav-component slim-scroll" data-v-e6005420><nav id="mb-page-nav" class="nav nav-pills flex-column my-0 small no-flex-wrap" data-v-e6005420><a class="nav-link py-1" href="#packages" data-v-e6005420>Packages‚Äé</a> <a class="nav-link py-1" href="#architecture" data-v-e6005420>Architecture‚Äé</a> <a class="nav-link py-1" href="#how-markbind-works" data-v-e6005420>How MarkBind Works‚Äé</a> <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap" data-v-e6005420><a class="nav-link py-1" href="#markbind-rendering-flow" data-v-e6005420>MarkBind Rendering Flow‚Äé</a> <a class="nav-link py-1" href="#vue-js-integration-in-markbind" data-v-e6005420>Vue.js Integration in MarkBind‚Äé</a> <a class="nav-link py-1" href="#build-process-and-asset-management" data-v-e6005420>Build Process and Asset Management‚Äé</a></nav> <!----></nav></div> <!----></nav> <div aria-hidden="true" class="scroll-top-button fa-lg d-print-none" style="display:none;bottom:2%;right:2%;position:fixed;"><i class="fas fa-arrow-circle-up"></i></div></div> <footer><div class="text-center"><small>[Generated by <a href="https://markbind.org/">MarkBind 5.5.3</a>]</small></div></footer></div>
</body><script src="/mb-architecture/markbind/js/bootstrap-utility.min.js"></script>
<script src="/mb-architecture/markbind/js/polyfill.min.js"></script>
<script src="/mb-architecture/markbind/js/vue.min.js"></script>
<script src="/mb-architecture/markbind/js/markbind.min.js"></script>
<script src="architecture.page-vue-render.js"></script>
<script>
  MarkBind.setupWithSearch()
</script>
</html>
